{% extends "staff/base.html" %}
{% import 'staff/_formhelpers.html' as forms with context %}

{% block title %} Create Category - {{ current_course.display_name_with_semester }}{% endblock %}

{% block main %}
  <section class="content-header">
      <h1>
        Create Category
        <small id="course-offering">{{ current_course.offering }}</small>
      </h1>
      <ol class="breadcrumb">
        <li><a href="{{ url_for('admin.course', cid=current_course.id) }}">
            <i class="fa fa-university"></i> {{ current_course.offering }}
        </a></li>
        <li><a href="{{ url_for('.course_assignments', cid=current_course.id) }}">
          <i class="fa fa-list"></i> Assignments</a>
        </li>
        <li class="active hidden-xs"><a href="#"><i class="fa fa-plus"></i> Create Category</a></li>
      </ol>
  </section>

  <section class="content">

    {% include 'alerts.html' %}
    <div class="row">
      <div class="col-md-12">
        <div class="box">
          <div class="box-body">
  {% call forms.render_form(form, action_text='Create Category', class_='form') %}
    {{ forms.render_field(form.name, required='true', type='text') }}
    <label class="control-label">Weighting Scheme</label>
    {{ forms.render_radio_field(form.weight_scheme)}}
    <div class="percentage">
      {{ forms.render_field(form.percentage, type='decimal', value=0.0) }}
    </div>
    <div class="points">
      {{ forms.render_field(form.points, type='number', value=0) }}
    </div>
  {% endcall %}
          </div>
        </div>
      </div>
    </div>
  <!-- </body> do not close body in template-->
{% endblock %}

{% block page_css %}
<style>
.percentage, .points {
  display: none;
}
</style>
{% endblock %}

{% block page_js %}
<script>
var currentScheme = $({{ current_weight_scheme }}).attr('id')
$('.' + currentScheme).css('display', 'block')

$("input[type='radio']").on('click', function(e) {
  $(".percentage, .points").css('display', 'none')
  $("." + e.target.value).css('display', 'block')
})

$("#percentage").on('keyup', debounce(function() {
  var input = $("#percentage")
  var currVal = Number(input.val())
  if (currVal <= 1)
    return
  while (currVal >= 1)
    currVal = currVal / 10
  input.val(currVal.toFixed(2))
}, 500))
</script>
{% endblock %}
